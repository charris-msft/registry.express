# MCP Registry Express - Copilot Instructions

This is a simplified MCP (Model Context Protocol) Registry for private/self-hosted scenarios.

## Project Structure

```
registry.express/
├── servers/           # JSON files containing MCP server definitions
├── schemas/           # Local copy of schema (reference only)
├── src/
│   ├── cli/          # CLI tool for managing the registry
│   └── web/          # Static web UI
├── scripts/          # Build scripts
├── tests/            # Test files (node:test)
├── dist/             # Generated static files (API + web)
└── .github/          # GitHub workflows and agent config
```

## Key Concepts

1. **Server Files**: MCP servers are stored as JSON files anywhere in `servers/` directory
2. **File Formats**: Supports both single-server and multi-server JSON formats
3. **Build Process**: `npm run build` aggregates all server files into API format in `dist/`
4. **API Compatibility**: Generated API matches the official MCP Registry API
5. **Schema**: Uses the [official MCP server schema](https://static.modelcontextprotocol.io/schemas/2025-10-17/server.schema.json)

## CLI Commands

> **Note:** Use `--` after `npm run cli` to pass arguments to the script.

```bash
# List servers in local registry
npm run cli -- list

# Search official registry
npm run cli -- search "azure"
npm run cli -- search "com.microsoft/azure|io.github.github/github-mcp-server"
npm run cli -- search "filesystem" --json    # Output server names only
npm run cli -- search "mcp" --limit 5        # Limit results

# Import from official registry
npm run cli -- import "com.microsoft/azure"
npm run cli -- import "com.microsoft/azure" --all-versions
npm run cli -- import "com.microsoft/azure" --file servers/my-servers.json

# Search and import all results
npm run cli -- search "com.microsoft/azure|io.github.github/github-mcp-server" --import-all

# Build the static API
npm run cli -- build

# Run tests
npm test
```

## Server JSON Formats

### Single Server Format
```json
{
  "$schema": "https://static.modelcontextprotocol.io/schemas/2025-10-17/server.schema.json",
  "name": "io.github.user/my-server",
  "description": "Description of what this server does",
  "repository": {
    "url": "https://github.com/user/repo",
    "source": "github"
  },
  "versions": [
    {
      "version": "1.0.0",
      "releaseDate": "2024-01-01",
      "isLatest": true,
      "packages": [
        {
          "registryType": "npm",
          "identifier": "@scope/package-name",
          "runtimeHint": "npx",
          "transport": { "type": "stdio" }
        }
      ]
    }
  ]
}
```

### Multi-Server Format
```json
{
  "$schema": "https://static.modelcontextprotocol.io/schemas/2025-10-17/server.schema.json",
  "servers": [
    {
      "name": "io.github.user/server-one",
      "description": "First server",
      "versions": [...]
    },
    {
      "name": "io.github.user/server-two",
      "description": "Second server",
      "versions": [...]
    }
  ]
}
```

## File Organization

Users can organize `servers/` directory however they prefer:
- By namespace: `servers/io.github.user/server.json`
- By category: `servers/databases/all.json`
- All-in-one: `servers/registry.json`
- Mixed: Any combination

The build system recursively finds all `.json` files in `servers/`.

## Rules

- **Server names**: Reverse-DNS format with exactly one slash (e.g., `io.github.user/server-name`)
- **Versions**: Semantic versioning (e.g., `1.0.0`, `2.1.0-beta.1`)
- **Latest flag**: Always set `isLatest: true` on the most recent version
- **Registry types**: `npm`, `pypi`, `oci`, `nuget`, `mcpb`
- **Runtime hints**: `npx`, `docker`, `dnx`, `python`, `uvx`, `binary`
- **Transport types**: `stdio`, `streamable-http`, `sse`

## Common Namespaces

- `io.github.{username}` - GitHub users/orgs
- `com.{company}` - Companies (e.g., `com.microsoft`)
- `io.modelcontextprotocol` - Official MCP servers

## Files to Never Edit Directly

- `dist/*` - Generated by build process
- `node_modules/*` - Dependencies

## Generated API Structure

After `npm run build`, the `dist/` directory contains:
- `api/v0.1/servers.json` - List of all servers with summaries
- `api/v0.1/servers/{encoded-name}/versions.json` - All versions for a server
- `api/v0.1/servers/{encoded-name}/versions/{version}.json` - Specific version
- `api/v0.1/servers/{encoded-name}/versions/latest.json` - Latest version
- `index.html`, `app.js`, `styles.css` - Web UI
- `schemas/` - Schema files
